<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Klan App Prototip</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <style>
    :root {
      --blue: #37a1f7;
      --red: #ff5757;
      --yellow: #ffd237;
      --purple: #b180ea;
      --gray: #262830;
    }
    body {margin:0; background:#1a1d23; color:#fff; font-family:'Segoe UI',Arial,sans-serif;}
    #app{max-width:960px;margin:28px auto 0 auto;border-radius:17px;box-shadow:0 4px 24px #0007;overflow:hidden;min-height:92vh;position:relative;}
    .klan-secim{padding:34px 14px 14px 14px; background:#242634;}
    .klanlar{display:flex;flex-wrap:wrap;justify-content:space-around;}
    .klan{flex:1 1 155px;margin:18px;background:#191b21;border-radius:18px;display:flex;flex-direction:column;align-items:center;padding:17px 0;cursor:pointer;transition:box-shadow .26s;}
    .klan.selected,.klan:hover{box-shadow:0 0 0 4px #fff6,0 6px 22px #0006;}
    .klan-blue{color:var(--blue);}
    .klan-red{color:var(--red);}
    .klan-yellow{color:var(--yellow);}
    .klan-purple{color:var(--purple);}
    .klan-symbol{font-size:44px;}
    .klan-name{font-size:1.15rem;font-weight:700;margin-top:7px;}
    .klan-desc{font-size:1rem;opacity:.66;}
    .join-btn{display:block;margin:34px auto 0 auto;font-size:1.14rem;padding:13px 45px;border:none;border-radius:31px;background:linear-gradient(90deg,var(--blue),var(--purple));color:#1a1d23;font-weight:700;cursor:pointer;box-shadow:0 2px 16px #0002;}
    .join-btn:disabled{background:#444;opacity:.7;cursor:not-allowed;}
    #oyunui{display:none;position:relative;}
    .logo-klan{position:absolute;left:24px;top:18px;z-index:99;display:flex;align-items:center;gap:10px;padding:7px 22px 7px 16px;background:#262830e6;border-radius:24px 27px 25px 27px;}
    .logo-icon{font-size:32px;}
    .logo-name{font-size:1.08rem;font-weight:700;letter-spacing:.02em;}
    .logo-klan-bottom{position:fixed;left:22px;bottom:22px;z-index:99;display:flex;align-items:center;gap:9px;padding:6px 22px 7px 13px;background:#23242eea;border-radius:21px 24px 23px 24px;box-shadow:0 3px 24px #0003;}
    .logo-icon-bottom{font-size:27px;}
    .logo-name-bottom{font-size:1.04rem;font-weight:700;}
    .jeton-bakiye{position:absolute;right:30px;top:18px;z-index:99;background:linear-gradient(90deg,#ffd237 70%,#f4ac35 95%);color:#191b21;border-radius:23px;padding:6px 20px 7px 15px;font-weight:700;display:flex;align-items:center;gap:8px;box-shadow:0 3px 22px #0002;}
    .jeton-icon{font-size:21px;}
    #menu{display:flex;justify-content:space-around;align-items:center;background:#232a36;}
    .menu-btn{flex:1 1 0;padding:13px 0 9px 0;font-size:1.03rem;color:#fff;background:none;border:none;cursor:pointer;display:flex;flex-direction:column;align-items:center;border-bottom:3px solid transparent;transition:border .2s;}
    .menu-btn.active,.menu-btn:hover{border-bottom:3px solid var(--purple);}
    .menu-icon{font-size:22px;margin-bottom:1px;}
    #icerik{background:#171b20;min-height:410px;padding:0;}
    #profil{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:35px 0;}
    .profile-klan{display:flex;align-items:center;margin-bottom:20px;}
    .profile-symbol{font-size:38px;margin-right:10px;}
    .profile-klan-name{font-size:1.15rem;font-weight:700;}
    .profile-data{font-size:1.05rem;margin:7px 0;display:flex;align-items:center;gap:9px;}
    .prof-ikon{font-size:20px;opacity:.85;}
    #map{width:100%;height:400px;min-height:280px;border-radius:0 0 17px 17px;}
    .tab-content{padding:48px 18px 33px 18px;text-align:center;}
    .tab-content h3{margin-bottom:14px;}
    .store-wrap{display:flex;flex-wrap:wrap;justify-content:center;gap:18px;}
    .store-product{background:#21242a;border-radius:16px;padding:18px 13px 17px 13px;margin:10px 2px;min-width:160px;flex:1 0 150px;max-width:200px;display:flex;flex-direction:column;align-items:center;transition:box-shadow .2s;}
    .store-product:hover{box-shadow:0 2px 24px #37a1f799;}
    .store-symbol{font-size:30px;margin-bottom:4px;}
    .store-name{font-size:1.02rem;font-weight:700;}
    .store-price{font-size:1.05rem;margin:6px 0 12px 0;color:#ffd237;}
    .store-btn{background:linear-gradient(90deg,#ffd237,#b180ea 70%);border:none;border-radius:21px;font-weight:700;color:#222;padding:7px 26px;cursor:pointer;}
    .ref-box{background:#22232a;border-radius:13px;padding:18px 10px 10px 10px;margin:16px auto 0 auto;max-width:370px;box-shadow:0 2px 14px #0002;}
    .ref-head{font-size:1.13rem;font-weight:700;margin-bottom:7px;}
    .ref-code{display:inline-block;background:#262830;border-radius:10px;padding:4px 18px;font-weight:700;letter-spacing:.1em;margin:0 0 6px 0;color:#ffd237;}
    .ref-btn{margin-left:12px;font-size:0.98rem;padding:5px 13px;border:none;border-radius:10px;background:#37a1f7;color:#101219;font-weight:700;cursor:pointer;}
    .ref-info{font-size:0.97rem;opacity:.7;margin-top:6px;}
    /* Klan Ateşi */
    .fire-map-wrap{display:flex;flex-direction:column;align-items:center;gap:12px;}
    .fire-badge{background:linear-gradient(90deg,#ff5757 80%,#ffd237);color:#fff;border-radius:13px;padding:7px 24px;font-weight:700;font-size:1.03rem;display:flex;align-items:center;gap:9px;margin-bottom:7px;}
    .fire-progress{background:#353535;border-radius:11px;width:220px;height:18px;overflow:hidden;margin:0 auto 7px auto;}
    .fire-progress-bar{height:100%;border-radius:11px;background:linear-gradient(90deg,#ff5757,#ffd237);text-align:left;color:#222;font-size:0.99rem;font-weight:700;padding-left:12px;line-height:18px;transition:width .3s;}
    /* Responsive */
    @media (max-width:650px){
      #app{max-width:100vw;margin:0;border-radius:0;}
      #icerik{min-height:250px;}
      #map{height:200px;}
      .klanlar{flex-direction:column;}
      .klan{margin:8px;}
      .logo-klan-bottom{left:5px;bottom:7px;}
      .jeton-bakiye{right:8px;}
    }
  </style>
</head>
<body>
<div id="app">
  <!-- Klan Seçim -->
  <div id="klansec" class="klan-secim">
    <h2 style="text-align:center;margin:24px 0 12px 0;letter-spacing:0.03em;">Klanını Seç</h2>
    <div class="klanlar">
      <div class="klan klan-blue" data-klan="blue">
        <span class="klan-symbol">🦅</span>
        <span class="klan-name">Mavi Klan</span>
        <span class="klan-desc">Strateji & Liderlik</span>
      </div>
      <div class="klan klan-red" data-klan="red">
        <span class="klan-symbol">🔥</span>
        <span class="klan-name">Kırmızı Klan</span>
        <span class="klan-desc">Cesaret & Enerji</span>
      </div>
      <div class="klan klan-yellow" data-klan="yellow">
        <span class="klan-symbol">🌟</span>
        <span class="klan-name">Sarı Klan</span>
        <span class="klan-desc">Sosyallik & Parlaklık</span>
      </div>
      <div class="klan klan-purple" data-klan="purple">
        <span class="klan-symbol">🦄</span>
        <span class="klan-name">Mor Klan</span>
        <span class="klan-desc">Hayal Gücü & Yaratıcılık</span>
      </div>
    </div>
    <button class="join-btn" id="joinBtn" disabled>KATIL</button>
  </div>
  <!-- Oyun UI -->
  <div id="oyunui">
    <!-- Sol üstte jeton bakiyesi -->
    <div class="jeton-bakiye"><span class="jeton-icon">🪙</span><span id="jetonSayisi">780</span></div>
    <!-- Sol üstte klan -->
    <div class="logo-klan" id="aktifKlan">
      <span class="logo-icon"></span>
      <span class="logo-name"></span>
    </div>
    <!-- Sol altta klan -->
    <div class="logo-klan-bottom" id="aktifKlanBottom">
      <span class="logo-icon-bottom"></span>
      <span class="logo-name-bottom"></span>
    </div>
    <!-- Menü -->
    <div id="menu">
      <button class="menu-btn active" data-tab="map"><span class="menu-icon">🗺️</span>Harita</button>
      <button class="menu-btn" data-tab="store"><span class="menu-icon">🏪</span>Mağaza</button>
      <button class="menu-btn" data-tab="fire"><span class="menu-icon">🔥</span>Klan Ateşi</button>
      <button class="menu-btn" data-tab="profile"><span class="menu-icon">👤</span>Profil</button>
      <button class="menu-btn" data-tab="flag"><span class="menu-icon">🚩</span>Bayrak Dik</button>
      <button class="menu-btn" data-tab="qr"><span class="menu-icon">🔳</span>QR</button>
      <button class="menu-btn" data-tab="ref"><span class="menu-icon">🎁</span>Davet</button>
    </div>
    <div id="icerik">
      <!-- Harita -->
      <div id="map-tab">
        <div id="map"></div>
      </div>
      <!-- Mağaza -->
      <div id="store-tab" class="tab-content" style="display:none;">
        <h3>Mağaza</h3>
        <div class="store-wrap">
          <div class="store-product"><span class="store-symbol" style="color:#e0e0e0;">⬛</span>
            <span class="store-name">Basic Bileklik</span>
            <span class="store-price">₺120</span>
            <button class="store-btn">Satın Al</button>
          </div>
          <div class="store-product"><span class="store-symbol" style="color:#37a1f7;">🦅</span>
            <span class="store-name">Mavi Klan Bileklik</span>
            <span class="store-price">₺300</span>
            <button class="store-btn">Satın Al</button>
          </div>
          <div class="store-product"><span class="store-symbol" style="color:#ff5757;">🔥</span>
            <span class="store-name">Kırmızı Klan Bileklik</span>
            <span class="store-price">₺300</span>
            <button class="store-btn">Satın Al</button>
          </div>
          <div class="store-product"><span class="store-symbol" style="color:#ffd237;">🌟</span>
            <span class="store-name">Sarı Klan Bileklik</span>
            <span class="store-price">₺300</span>
            <button class="store-btn">Satın Al</button>
          </div>
          <div class="store-product"><span class="store-symbol" style="color:#b180ea;">🦄</span>
            <span class="store-name">Mor Klan Bileklik</span>
            <span class="store-price">₺350</span>
            <button class="store-btn">Satın Al</button>
          </div>
          <div class="store-product"><span class="store-symbol" style="color:#ffd237;">💎</span>
            <span class="store-name">Premium Bileklik</span>
            <span class="store-price">₺500</span>
            <button class="store-btn">Satın Al</button>
          </div>
        </div>
      </div>
      <!-- Klan Ateşi -->
      <div id="fire-tab" class="tab-content" style="display:none;">
        <h3>Klan Ateşi</h3>
        <div class="fire-map-wrap">
          <div class="fire-badge"><span style="font-size:23px;">🔥</span>Klan Ateşi Aktif! / Kadıköy</div>
          <div class="fire-progress"><div class="fire-progress-bar" id="fireProgBar" style="width:33%;">1 / 3 Katılımcı</div></div>
          <button class="store-btn" onclick="katilimciArttir()">Katıldım!</button>
        </div>
        <p style="margin-top:13px;opacity:.85;font-size:0.97rem;">3 kişi olunca ateş yanacak ve tüm katılımcılar ekstra jeton kazanacak!</p>
      </div>
      <!-- Profil -->
      <div id="profile-tab" style="display:none;">
        <div id="profil">
          <div class="profile-klan">
            <span class="profile-symbol"></span>
            <span class="profile-klan-name"></span>
          </div>
          <div class="profile-data"><span class="prof-ikon">⭐</span>Puan: <span id="puan">9/10</span></div>
          <div class="profile-data"><span class="prof-ikon">👥</span>Arkadaş: <span id="arkadas">4</span></div>
          <div class="profile-data"><span class="prof-ikon">⚡</span>Seviye: <span id="seviye">2</span></div>
          <div class="profile-data"><span class="prof-ikon">🥇</span>Rütbe: <span id="rutbe">Ateşçi</span></div>
        </div>
      </div>
      <!-- Bayrak Dik -->
      <div id="flag-tab" class="tab-content" style="display:none;">
        <h3>Bayrak Dik</h3>
        <p>Haritada klanının alanını fethet!</p>
        <button class="store-btn">Bayrak Dik!</button>
      </div>
      <!-- QR -->
      <div id="qr-tab" class="tab-content" style="display:none;">
        <h3>QR</h3>
        <p>Arkadaş ekle ya da görev doğrula!</p>
        <img src="https://api.qrserver.com/v1/create-qr-code/?data=KlanApp-23456&size=140x140" alt="QR Kod" style="width:110px;border-radius:15px;margin:22px auto;">
      </div>
      <!-- Referans/Davet -->
      <div id="ref-tab" class="tab-content" style="display:none;">
        <div class="ref-box">
          <div class="ref-head">Davet & Referans</div>
          <div>Referans Kodun:</div>
          <div class="ref-code" id="refKod">EMIR23</div>
          <button class="ref-btn" onclick="kopyala()">Kopyala</button>
          <div class="ref-info">Her yeni üye başına <b>+50 jeton</b> kazanırsın.<br>Davet linkiyle veya kodunla paylaş!</div>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
const klans={
  blue:{name:"Mavi Klan",color:"#37a1f7",symbol:"🦅",desc:"Strateji & Liderlik"},
  red:{name:"Kırmızı Klan",color:"#ff5757",symbol:"🔥",desc:"Cesaret & Enerji"},
  yellow:{name:"Sarı Klan",color:"#ffd237",symbol:"🌟",desc:"Sosyallik & Parlaklık"},
  purple:{name:"Mor Klan",color:"#b180ea",symbol:"🦄",desc:"Hayal Gücü & Yaratıcılık"}
}; let seciliKlan=null,fireCount=1,jeton=780;

// Klan seçimi
document.querySelectorAll('.klan').forEach(k=>{
  k.onclick=()=>{
    document.querySelectorAll('.klan').forEach(el=>el.classList.remove('selected'));
    k.classList.add('selected');
    seciliKlan=k.dataset.klan;
    document.getElementById('joinBtn').disabled=false;
  }
});
document.getElementById('joinBtn').onclick=()=>{
  document.getElementById('klansec').style.display='none';
  document.getElementById('oyunui').style.display='block';
  const klan=klans[seciliKlan];
  // Tema rengi ayarla
  document.documentElement.style.setProperty('--theme',klan.color);
  // Sol üstte klan
  document.querySelector('#aktifKlan .logo-icon').innerText=klan.symbol;
  document.querySelector('#aktifKlan .logo-name').innerText=klan.name;
  document.querySelector('#aktifKlan').style.background=klan.color+'d0';
  // Sol altta klan
  document.querySelector('#aktifKlanBottom .logo-icon-bottom').innerText=klan.symbol;
  document.querySelector('#aktifKlanBottom .logo-name-bottom').innerText=klan.name;
  document.querySelector('#aktifKlanBottom').style.background=klan.color+'c8';
  // Profilde klan
  document.querySelector('.profile-symbol').innerText=klan.symbol;
  document.querySelector('.profile-klan-name').innerText=klan.name;
  setTimeout(initMap,30);
}

// Menü geçişleri
document.querySelectorAll('.menu-btn').forEach(btn=>{
  btn.onclick=()=>{
    document.querySelectorAll('.menu-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    ['map','store','fire','profile','flag','qr','ref'].forEach(tab=>{
      document.getElementById(tab+'-tab').style.display=(btn.dataset.tab==tab)?'block':'none';
    });
    if(btn.dataset.tab==="map" && window.leafletMap) setTimeout(()=>{window.leafletMap.invalidateSize()},60);
  }
});

// Harita ve ateş
function initMap(){
  window.leafletMap=L.map('map').setView([39,34],2);
  L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png',{
    maxZoom:19,attribution:'&copy; <a href="https://carto.com/">CartoDB</a>'
  }).addTo(window.leafletMap);
  L.marker([41.02,29.02]).addTo(window.leafletMap).bindPopup('🦅 <b>Mavi Klan</b> – Kadıköy');
  L.marker([39.92,32.85]).addTo(window.leafletMap).bindPopup('🔥 <b>Kırmızı Klan</b> – Ankara');
  L.marker([40.72,30.41]).addTo(window.leafletMap).bindPopup('🌟 <b>Sarı Klan</b> – Sakarya');
  L.marker([38.43,27.15]).addTo(window.leafletMap).bindPopup('🦄 <b>Mor Klan</b> – İzmir');
  // Klan Ateşi
  let fireIcon=L.divIcon({html:'<span style="font-size:30px;">🔥</span>',className:''});
  window.fireMarker=L.marker([40.99,29.06],{icon:fireIcon}).addTo(window.leafletMap).bindPopup('<b>Klan Ateşi</b><br>Katılım: <span id="fire-popup-cnt">1/3</span>');
}
function katilimciArttir(){
  if(fireCount<3){fireCount++;document.getElementById('fireProgBar').style.width=(fireCount*33)+'%';document.getElementById('fireProgBar').innerText=fireCount+' / 3 Katılımcı';
  if(window.fireMarker)window.fireMarker.bindPopup('<b>Klan Ateşi</b><br>Katılım: <span id="fire-popup-cnt">'+fireCount+'/3</span>');}
  else{alert("Ateş yandı! +50 jeton kazandın.");jeton+=50;document.getElementById('jetonSayisi').innerText=jeton;}
}
// Referans kopyala
function kopyala(){navigator.clipboard.writeText(document.getElementById('refKod').innerText);alert("Kod kopyalandı!");}
</script>
</body>
</html>
