<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Klan Uygulamasƒ±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <style>
    :root {
      --mavi: #37a1f7;
      --kirmizi: #ff5757;
      --sari: #ffd237;
      --mor: #b180ea;
      --arka: #171b20;
      --kutu: #23242e;
      --beyaz: #fff;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      background: var(--arka);
      color: var(--beyaz);
      font-family: 'Segoe UI', Arial, sans-serif;
    }
    body {
      min-height: 100vh;
      height: 100vh;
      width: 100vw;
      overflow: hidden;
    }
    #app {
      height: 100vh;
      min-height: 100vh;
      width: 100vw;
      max-width: 100vw;
      display: flex;
      flex-direction: column;
      position: relative;
      background: var(--arka);
    }
    /* Klan Se√ßimi */
    #klanSec {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: var(--arka);
      width: 100vw;
      height: 100vh;
      min-height: 100vh;
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      z-index: 10;
    }
    .klanlar {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 16px;
      margin-top: 24px;
      width: 95vw;
      max-width: 450px;
    }
    .klan {
      flex: 1 1 140px;
      min-width: 110px;
      background: var(--kutu);
      border-radius: 18px;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 0 10px 0;
      cursor: pointer;
      transition: box-shadow .22s;
      border: 2px solid transparent;
    }
    .klan.selected,.klan:hover{box-shadow:0 0 0 4px #fff3;}
    .klan-blue { color: var(--mavi);}
    .klan-red { color: var(--kirmizi);}
    .klan-yellow { color: var(--sari);}
    .klan-purple { color: var(--mor);}
    .klan-symbol { font-size: 38px; }
    .klan-name { font-size: 1.12rem; font-weight: bold; margin-top: 8px;}
    .klan-desc { font-size: .97rem; opacity: .7;}
    .katil-btn {
      margin: 32px auto 0 auto;
      padding: 13px 52px;
      border: none;
      border-radius: 24px;
      font-size: 1.1rem;
      font-weight: 700;
      color: #171b20;
      background: linear-gradient(90deg, var(--mavi), var(--mor));
      cursor: pointer;
      box-shadow: 0 2px 12px #0003;
      display: block;
    }
    .katil-btn:disabled {
      background: #444;
      opacity: .7;
      cursor: not-allowed;
    }
    /* Men√º */
    #menu {
      width: 100vw;
      background: var(--kutu);
      display: flex;
      justify-content: space-around;
      align-items: center;
      height: 57px;
      border-top: 1px solid #202124;
      position: fixed;
      bottom: 0; left: 0; right: 0;
      z-index: 30;
    }
    .menu-btn {
      flex: 1 1 0;
      font-size: .98rem;
      color: #fff;
      background: none;
      border: none;
      padding: 0;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-bottom: 3px solid transparent;
      transition: border .2s;
      cursor: pointer;
    }
    .menu-btn.active,
    .menu-btn:hover {
      border-bottom: 3px solid var(--mor);
      color: var(--mor);
    }
    .menu-icon { font-size: 21px; margin-bottom: 2px;}
    /* ƒ∞√ßerik */
    #icerik {
      flex: 1 1 auto;
      min-height: 0;
      background: var(--arka);
      position: relative;
      margin-bottom: 57px;
      overflow-y: auto;
      height: calc(100vh - 57px);
    }
    /* Harita */
    #map {
      width: 100vw;
      height: 48vh;
      min-height: 230px;
      border-radius: 0 0 16px 16px;
      z-index: 1;
      box-shadow: 0 8px 18px #0004;
    }
    /* Sol alt butonlar */
    .solalt-klanbox{
      position: absolute;
      left: 14px; bottom: 20px;
      z-index: 20;
      display: flex; flex-direction: column; align-items: flex-start;
      gap: 10px;
    }
    .klaninfo-btn{
      display:flex;align-items:center;gap:8px;
      background:var(--kutu);color:#fff;border-radius:14px;
      padding:10px 21px;cursor:pointer;box-shadow:0 1px 6px #0003;
      font-weight: 600;
      border: 2px solid #fff1; min-width: 120px;
      font-size: 1.06rem;
    }
    .klaninfo-symbol{font-size: 25px;}
    .klaninfo-popup{
      display:none;position:absolute;bottom:54px;left:0;z-index:99;
      background:#262730e6;padding:15px 15px 12px 16px;border-radius:15px;
      min-width:170px;box-shadow:0 2px 14px #0007;font-size:.98rem;
    }
    .klaninfo-popup.active{display:block;animation:fadeIn .2s;}
    .tumklanlar-btn{
      width:39px;height:39px;display:flex;align-items:center;justify-content:center;
      background:var(--mavi);color:#fff;border-radius:11px;cursor:pointer;box-shadow:0 2px 9px #0002;font-size: 20px;}
    .tumklanlar-popup{
      display:none;position:absolute;bottom:110px;left:0;z-index:100;
      background:#23242ae9;padding:12px 13px 11px 13px;border-radius:12px;
      min-width:180px;box-shadow:0 2px 18px #0007;font-size:.96rem;
    }
    .tumklanlar-popup.active{display:block;animation:fadeIn .22s;}
    /* Maƒüaza */
    .store-wrap{display:flex;flex-wrap:wrap;justify-content:center;gap:12px;}
    .store-product{background:#22252a;border-radius:14px;padding:16px 10px 14px 10px;margin:8px 2px;min-width:115px;flex:1 0 120px;max-width:155px;display:flex;flex-direction:column;align-items:center;}
    .store-symbol{font-size:25px;margin-bottom:3px;}
    .store-name{font-size:1.01rem;font-weight:700;}
    .store-price{font-size:1rem;margin:5px 0 9px 0;color:#ffd237;}
    .store-btn{background:linear-gradient(90deg,#ffd237,#b180ea 70%);border:none;border-radius:12px;font-weight:700;color:#23222f;padding:6px 13px;cursor:pointer;}
    /* Diƒüer */
    .tab-content{padding:18px 10px 10px 10px;text-align:center;}
    .profile-klan{display:flex;align-items:center;margin-bottom:16px;}
    .profile-symbol{font-size:26px;margin-right:7px;}
    .profile-klan-name{font-size:1.07rem;font-weight:600;}
    .profile-data{font-size:.97rem;margin:5px 0;display:flex;align-items:center;gap:7px;}
    .prof-ikon{font-size:17px;opacity:.85;}
    /* Responsive */
    @media (max-width:650px){
      html, body, #app{height:100vh;min-height:100vh;max-width:100vw;}
      #icerik{height:calc(100vh - 57px);}
      .klanlar{max-width:99vw;}
      #map{height:36vh;}
      .solalt-klanbox{left:2vw;bottom:12vw;}
    }
    @keyframes fadeIn{0%{opacity:0;transform:translateY(16px);}100%{opacity:1;transform:none;}}
  </style>
</head>
<body>
<div id="app">
  <!-- Klan Se√ßimi -->
  <div id="klanSec">
    <h2>Klanƒ±nƒ± Se√ß</h2>
    <div class="klanlar">
      <div class="klan klan-blue" data-klan="blue">
        <span class="klan-symbol">ü¶Ö</span>
        <span class="klan-name">Mavi</span>
        <span class="klan-desc">Strateji</span>
      </div>
      <div class="klan klan-red" data-klan="red">
        <span class="klan-symbol">üî•</span>
        <span class="klan-name">Kƒ±rmƒ±zƒ±</span>
        <span class="klan-desc">Cesaret</span>
      </div>
      <div class="klan klan-yellow" data-klan="yellow">
        <span class="klan-symbol">üåü</span>
        <span class="klan-name">Sarƒ±</span>
        <span class="klan-desc">Sosyallik</span>
      </div>
      <div class="klan klan-purple" data-klan="purple">
        <span class="klan-symbol">ü¶Ñ</span>
        <span class="klan-name">Mor</span>
        <span class="klan-desc">Yaratƒ±cƒ±lƒ±k</span>
      </div>
    </div>
    <button class="katil-btn" id="katilBtn" disabled>KATIL</button>
  </div>

  <!-- Ana UI -->
  <div id="oyunui" style="display:none;height:100vh;width:100vw;position:relative;">
    <!-- Sol alt klan ve istatistik -->
    <div class="solalt-klanbox" id="solaltBox" style="display:none;">
      <div class="tumklanlar-btn" id="tumKlanBtn" title="Klan Sƒ±ralamasƒ±">üèÜ</div>
      <div class="klaninfo-btn" id="klanInfoBtn"><span class="klaninfo-symbol"></span><span class="klaninfo-name"></span></div>
      <div class="klaninfo-popup" id="klanInfoPopup"></div>
      <div class="tumklanlar-popup" id="tumKlanlarPopup"></div>
    </div>

    <div id="icerik">
      <!-- Harita -->
      <div id="map-tab">
        <div id="map"></div>
      </div>
      <!-- Maƒüaza -->
      <div id="store-tab" class="tab-content" style="display:none;">
        <h3>Maƒüaza</h3>
        <div class="store-wrap" id="magazaBileklikler"></div>
      </div>
      <!-- Profil -->
      <div id="profile-tab" class="tab-content" style="display:none;">
        <h3>Profil</h3>
        <div class="profile-klan">
          <span class="profile-symbol"></span>
          <span class="profile-klan-name"></span>
        </div>
        <div class="profile-data"><span class="prof-ikon">‚≠ê</span>Puan: <span id="puan">9/10</span></div>
        <div class="profile-data"><span class="prof-ikon">üë•</span>Arkada≈ü: <span id="arkadas">4</span></div>
        <div class="profile-data"><span class="prof-ikon">‚ö°</span>Seviye: <span id="seviye">2</span></div>
        <div class="profile-data"><span class="prof-ikon">ü•á</span>R√ºtbe: <span id="rutbe">Ate≈ü√ßi</span></div>
      </div>
    </div>

    <!-- Men√º -->
    <div id="menu">
      <button class="menu-btn active" data-tab="map"><span class="menu-icon">üó∫Ô∏è</span>Harita</button>
      <button class="menu-btn" data-tab="store"><span class="menu-icon">üè™</span>Maƒüaza</button>
      <button class="menu-btn" data-tab="profile"><span class="menu-icon">üë§</span>Profil</button>
    </div>
  </div>
</div>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
// Klanlar ve sahte istatistikler
const klans = {
  blue:   {name:"Mavi",   color:"#37a1f7", symbol:"ü¶Ö", desc:"Strateji", bileklikler:["√áƒ±rak","Usta","Kartal","Lider"] },
  red:    {name:"Kƒ±rmƒ±zƒ±", color:"#ff5757", symbol:"üî•", desc:"Cesaret", bileklikler:["√áƒ±rak","Usta","Alev","Sava≈ü√ßƒ±"] },
  yellow: {name:"Sarƒ±",    color:"#ffd237", symbol:"üåü", desc:"Sosyallik", bileklikler:["√áƒ±rak","Usta","Yƒ±ldƒ±z","Parlak"] },
  purple: {name:"Mor",   color:"#b180ea", symbol:"ü¶Ñ", desc:"Yaratƒ±cƒ±lƒ±k", bileklikler:["√áƒ±rak","Usta","Unicorn","Sanat√ßƒ±"] }
};
const tumKlanlarStats = [
  {rank:1, name:"Sarƒ±", symbol:"üåü", color:"#ffd237", puan:7400, bayrak:18, uye:600},
  {rank:2, name:"Mor", symbol:"ü¶Ñ", color:"#b180ea", puan:6890, bayrak:16, uye:570},
  {rank:3, name:"Kƒ±rmƒ±zƒ±", symbol:"üî•", color:"#ff5757", puan:6550, bayrak:13, uye:540},
  {rank:4, name:"Mavi", symbol:"ü¶Ö", color:"#37a1f7", puan:6290, bayrak:11, uye:490},
];
let seciliKlan = null;
// Klan se√ßimi
document.querySelectorAll('.klan').forEach(k=>{
  k.onclick=()=>{
    document.querySelectorAll('.klan').forEach(el=>el.classList.remove('selected'));
    k.classList.add('selected');
    seciliKlan=k.dataset.klan;
    document.getElementById('katilBtn').disabled=false;
  }
});
document.getElementById('katilBtn').onclick=()=>{
  document.getElementById('klanSec').style.display='none';
  document.getElementById('oyunui').style.display='block';
  document.getElementById('solaltBox').style.display = "flex";
  const klan = klans[seciliKlan];
  // Sol alt klan info
  document.querySelector('.klaninfo-symbol').innerText = klan.symbol;
  document.querySelector('.klaninfo-name').innerText = klan.name;
  // Profilde klan
  document.querySelector('.profile-symbol').innerText = klan.symbol;
  document.querySelector('.profile-klan-name').innerText = klan.name;
  // Klan info popup i√ßerik
  guncelleKlanPopup();
  // T√ºm klan popup
  guncelleTumKlanlar();
  // Maƒüaza
  const magaza = document.getElementById('magazaBileklikler');
  magaza.innerHTML = '';
  klan.bileklikler.forEach((b,i)=>{
    magaza.innerHTML += `
      <div class="store-product">
        <span class="store-symbol" style="color:${klan.color};">${klan.symbol}</span>
        <span class="store-name">${klan.name} ${b} Bileklik</span>
        <span class="store-price">‚Ç∫${120+30*i}</span>
        <button class="store-btn">Satƒ±n Al</button>
      </div>
    `;
  });
  setTimeout(initMap,80);
}

// Sol alt klan info ve t√ºm klanlar popup
function guncelleKlanPopup(){
  if(!seciliKlan) return;
  let klan = klans[seciliKlan], stat = tumKlanlarStats.find(k=>k.name==klan.name);
  let info = `<h4>${klan.symbol} ${klan.name}</h4>
    <div><b>üåü Puan:</b> ${stat?.puan||"--"}<br>
      <b>üö© Bayrak:</b> ${stat?.bayrak||"--"}<br>
      <b>üë• √úye:</b> ${stat?.uye||
